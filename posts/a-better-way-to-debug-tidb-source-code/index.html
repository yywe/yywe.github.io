<!DOCTYPE html><html lang="en" data-mode="dark" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="generator" content="Jekyll v4.2.1" /><meta property="og:title" content="A Better Way to Debug TiDB Source Code" /><meta name="author" content="Hulua" /><meta property="og:locale" content="en" /><meta name="description" content="TiDB is an interesting SQL database written in Golang. One major difference compared with popular exsiting relational databases is that in TiDB storage is separated as an independant runtime. The database (SQL) layer will call the storage layer to access data." /><meta property="og:description" content="TiDB is an interesting SQL database written in Golang. One major difference compared with popular exsiting relational databases is that in TiDB storage is separated as an independant runtime. The database (SQL) layer will call the storage layer to access data." /><link rel="canonical" href="https://yywe.github.io/posts/a-better-way-to-debug-tidb-source-code/" /><meta property="og:url" content="https://yywe.github.io/posts/a-better-way-to-debug-tidb-source-code/" /><meta property="og:site_name" content="Hulua" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2022-04-08T08:55:00-04:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="A Better Way to Debug TiDB Source Code" /><meta name="twitter:site" content="@Hulua" /><meta name="twitter:creator" content="@Hulua" /><meta name="google-site-verification" content="liMLPEFk1OeBj60sNB4ZWXljAWSaM_5PT6cFO3qH-kg" /> <script type="application/ld+json"> {"author":{"@type":"Person","name":"Hulua"},"description":"TiDB is an interesting SQL database written in Golang. One major difference compared with popular exsiting relational databases is that in TiDB storage is separated as an independant runtime. The database (SQL) layer will call the storage layer to access data.","headline":"A Better Way to Debug TiDB Source Code","dateModified":"2022-04-08T09:07:44-04:00","url":"https://yywe.github.io/posts/a-better-way-to-debug-tidb-source-code/","datePublished":"2022-04-08T08:55:00-04:00","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"https://yywe.github.io/posts/a-better-way-to-debug-tidb-source-code/"},"@context":"https://schema.org"}</script><title>A Better Way to Debug TiDB Source Code | Hulua</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="Hulua"><meta name="application-name" content="Hulua"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" crossorigin><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato&family=Source+Sans+Pro:wght@400;600;700;900&display=swap"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1/dist/magnific-popup.min.css"> <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script><body data-spy="scroll" data-target="#toc" data-topbar-visible="true"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> <img src="/assets/img/favicons/favicon.ico" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">Hulua</a></div><div class="site-subtitle font-italic">Welcome to my home page</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <a href="https://github.com/yywe" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github"></i> </a> <a href="https://twitter.com/Hulua" aria-label="twitter" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['stweiyy','gmail.com'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></div><div id="topbar-wrapper" class="row justify-content-center"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>A Better Way to Debug TiDB Source Code</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="core-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>A Better Way to Debug TiDB Source Code</h1><div class="post-meta text-muted"><div> By <em> Hulua </em></div><div class="d-flex"><div> <span> Posted <em class="timeago" data-ts="1649422500" data-toggle="tooltip" data-placement="bottom" data-tooltip-df="llll" > 2022-04-08 </em> </span> <span> Updated <em class="timeago" data-ts="1649423264" data-toggle="tooltip" data-placement="bottom" data-tooltip-df="llll" > 2022-04-08 </em> </span> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="722 words"> <em>4 min</em> read</span> <span> read by <em id="mypv" class="pageviews"> <i class="fas fa-spinner fa-spin fa-fw"></i> </em> visitor </span> <span><i class="far fa-thumbs-up fa-fw" id="thumbsupbtn" ></i> <span><em id="postsabetterwaytodebugtidbsourcecode" class="num_of_likes"></em></span> </span></div></div></div><div class="post-content"><p><a href="https://github.com/pingcap/tidb">TiDB</a> is an interesting SQL database written in Golang. One major difference compared with popular exsiting relational databases is that in TiDB storage is separated as an independant runtime. The database (SQL) layer will call the storage layer to access data.</p><p>For database learners, most of us actually will only be interest in the SQL part, i.e, from SQL statment in string form how we can get the query result. Although other parts like server or authtication are also essential parts for a database product, we do not really care about them if we just need to learn database principles.</p><p>The official <a href="https://pingcap.github.io/tidb-dev-guide/understand-tidb/the-lifecycle-of-a-statement.html">document</a> demenstrated the whole lifecyle of an SQL statement in the production environment, and we can follow this <a href="https://pingcap.github.io/tidb-dev-guide/get-started/debug-and-profile.html">guide</a> to debug TiDB.</p><p>However, the above debug process is cubersome. You will launch the database server, use MySQL client to send SQL querys. This is not really nessesary if we just want to track the execution of a single SQL statement. Meanwhile, when you set a break point and want to observe your expected SQL statement, the debugger will also break if it encounter some other statements triggered by the server itself or some other components, this is annoying. Is there a better way to debug a single SQL statement?</p><p>That is the motivation for this post. We will show how we can achieve this using the below code.</p><div class="language-go highlighter-rouge"><div class="code-header"> <span data-label-text="Go"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
</pre><td class="rouge-code"><pre>
<span class="c">/*
A simple Go program aims for better debugging SQL execution process in TiDB.
Thus you can focus on Parsing, OPtimization and Execution without distraction
from the server part and connecton part. In addtion, no MySQL client is required.

Usuage:

1. Go to the tidb source folder, and create a folder like 'sqlexec', 
   and copy the following code into sqlexec/main.go

2. Compile and execute:
go build sqlexec/main.go &amp;&amp; ./main

3. Debug:
dlv debug sqlexec/main.go

Enjoy!
*/</span>

<span class="k">package</span> <span class="n">main</span>

<span class="k">import</span> <span class="p">(</span>
	<span class="s">"context"</span>
	<span class="s">"fmt"</span>

	<span class="s">"github.com/pingcap/tidb/parser/terror"</span>
	<span class="s">"github.com/pingcap/tidb/session"</span>
	<span class="n">kvstore</span> <span class="s">"github.com/pingcap/tidb/store"</span>
	<span class="s">"github.com/pingcap/tidb/store/mockstore"</span>
<span class="p">)</span>

<span class="k">func</span> <span class="n">main</span><span class="p">()</span> <span class="p">{</span>
	<span class="c">//1. Prepare storage, use your existing store path, tables are there</span>
	<span class="n">storePath</span> <span class="o">:=</span> <span class="s">"unistore:///tmp/tidb"</span>
	<span class="n">err</span> <span class="o">:=</span> <span class="n">kvstore</span><span class="o">.</span><span class="n">Register</span><span class="p">(</span><span class="s">"unistore"</span><span class="p">,</span> <span class="n">mockstore</span><span class="o">.</span><span class="n">EmbedUnistoreDriver</span><span class="p">{})</span>
	<span class="n">terror</span><span class="o">.</span><span class="n">MustNil</span><span class="p">(</span><span class="n">err</span><span class="p">)</span>
	<span class="n">storage</span><span class="p">,</span> <span class="n">err</span> <span class="o">:=</span> <span class="n">kvstore</span><span class="o">.</span><span class="n">New</span><span class="p">(</span><span class="n">storePath</span><span class="p">)</span>
	<span class="n">terror</span><span class="o">.</span><span class="n">MustNil</span><span class="p">(</span><span class="n">err</span><span class="p">)</span>

	<span class="c">//2. Prepare a session and set the working database</span>
	<span class="n">se</span><span class="p">,</span> <span class="n">err</span> <span class="o">:=</span> <span class="n">session</span><span class="o">.</span><span class="n">CreateSession4Test</span><span class="p">(</span><span class="n">storage</span><span class="p">)</span>
	<span class="n">terror</span><span class="o">.</span><span class="n">MustNil</span><span class="p">(</span><span class="n">err</span><span class="p">)</span>
	<span class="n">se</span><span class="o">.</span><span class="n">GetSessionVars</span><span class="p">()</span><span class="o">.</span><span class="n">CurrentDB</span> <span class="o">=</span> <span class="s">"test"</span>
	<span class="n">terror</span><span class="o">.</span><span class="n">MustNil</span><span class="p">(</span><span class="n">err</span><span class="p">)</span>

	<span class="c">//3. The sql statement you want to execute</span>
	<span class="c">//sql := "insert into t1 values(5,'lucy','newyork','female')"</span>
	<span class="n">sql</span> <span class="o">:=</span> <span class="s">"select * from t1 where id &lt;=3"</span>

	<span class="c">//4. Parse and Execute.</span>
	<span class="n">ctx</span> <span class="o">:=</span> <span class="n">context</span><span class="o">.</span><span class="n">Background</span><span class="p">()</span>
	<span class="n">stmts</span><span class="p">,</span> <span class="n">err</span> <span class="o">:=</span> <span class="n">se</span><span class="o">.</span><span class="n">Parse</span><span class="p">(</span><span class="n">ctx</span><span class="p">,</span> <span class="n">sql</span><span class="p">)</span>
	<span class="n">terror</span><span class="o">.</span><span class="n">MustNil</span><span class="p">(</span><span class="n">err</span><span class="p">)</span>
	<span class="n">rs</span><span class="p">,</span> <span class="n">err</span> <span class="o">:=</span> <span class="n">se</span><span class="o">.</span><span class="n">ExecuteStmt</span><span class="p">(</span><span class="n">ctx</span><span class="p">,</span> <span class="n">stmts</span><span class="p">[</span><span class="m">0</span><span class="p">])</span>
	<span class="n">terror</span><span class="o">.</span><span class="n">MustNil</span><span class="p">(</span><span class="n">err</span><span class="p">)</span>

	<span class="c">//5. Get result for select statement</span>
	<span class="k">if</span> <span class="n">rs</span> <span class="o">!=</span> <span class="no">nil</span> <span class="p">{</span>
		<span class="n">sRows</span><span class="p">,</span> <span class="n">err</span> <span class="o">:=</span> <span class="n">session</span><span class="o">.</span><span class="n">ResultSetToStringSlice</span><span class="p">(</span><span class="n">ctx</span><span class="p">,</span> <span class="n">se</span><span class="p">,</span> <span class="n">rs</span><span class="p">)</span>
		<span class="n">terror</span><span class="o">.</span><span class="n">MustNil</span><span class="p">(</span><span class="n">err</span><span class="p">)</span>
		<span class="n">fmt</span><span class="o">.</span><span class="n">Println</span><span class="p">(</span><span class="s">"Query Result:"</span><span class="p">,</span> <span class="n">sRows</span><span class="p">)</span>
	<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
		<span class="n">fmt</span><span class="o">.</span><span class="n">Println</span><span class="p">(</span><span class="s">"Execution Succeed"</span><span class="p">)</span>
	<span class="p">}</span>
<span class="p">}</span>
</pre></table></code></div></div><div class="language-console highlighter-rouge"><div class="code-header"> <span data-label-text="Console"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
</pre><td class="rouge-code"><pre><span class="go">go build sqlexec/main.go &amp;&amp; ./main
[2022/04/08 08:29:01.448 -04:00] [INFO] [store.go:74] ["new store"] [path=unistore:///tmp/tidb]
[2022/04/08 08:29:01.493 -04:00] [INFO] [db.go:143] ["replay wal"] ["first key"=7580000000000000255f728000000000000001f9ffe9defe5fffff(432369895244562432)]
[2022/04/08 08:29:01.494 -04:00] [INFO] [store.go:80] ["new store with retry success"]
[2022/04/08 08:29:01.494 -04:00] [INFO] [tidb.go:72] ["new domain"] [store=6ebcd41f-95db-42e6-a785-e40ae59d567b] ["ddl lease"=1s] ["stats lease"=3s] ["index usage sync lease"=0s]
[2022/04/08 08:29:01.503 -04:00] [INFO] [domain.go:169] ["full load InfoSchema success"] [currentSchemaVersion=0] [neededSchemaVersion=37] ["start time"=5.741453ms]
[2022/04/08 08:29:01.503 -04:00] [INFO] [domain.go:432] ["full load and reset schema validator"]
[2022/04/08 08:29:01.503 -04:00] [INFO] [ddl.go:366] ["[ddl] start DDL"] [ID=c7216a3b-520a-4471-86fe-080e30c4d09b] [runWorker=true]
[2022/04/08 08:29:01.504 -04:00] [INFO] [ddl.go:355] ["[ddl] start delRangeManager OK"] ["is a emulator"=true]
[2022/04/08 08:29:01.504 -04:00] [WARN] [sysvar_cache.go:54] ["sysvar cache is empty, triggering rebuild"]
[2022/04/08 08:29:01.504 -04:00] [INFO] [delete_range.go:142] ["[ddl] start delRange emulator"]
[2022/04/08 08:29:01.504 -04:00] [INFO] [ddl_worker.go:156] ["[ddl] start DDL worker"] [worker="worker 1, tp general"]
[2022/04/08 08:29:01.504 -04:00] [INFO] [ddl_worker.go:156] ["[ddl] start DDL worker"] [worker="worker 2, tp add index"]
Query Result: [[1 zhangsan chongqing male] [2 lishi beijing female] [3 wang shandong male]]

</span></pre></table></code></div></div><p>With the above code, you can perfectly dive into the internals of SQL execution process, no need to worry about server start, connect with MySQL client, etc. After get familar with the the three essential steps (Parser, Planner, Executor, this may take some time), we can then go back to learn other components.</p></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/database/'>Database</a>, <a href='/categories/tidb/'>TiDB</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/tidb/" class="post-tag no-text-decoration" >TiDB</a> <a href="/tags/debug/" class="post-tag no-text-decoration" >debug</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=A+Better+Way+to+Debug+TiDB+Source+Code+-+Hulua&url=https%3A%2F%2Fyywe.github.io%2Fposts%2Fa-better-way-to-debug-tidb-source-code%2F" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=A+Better+Way+to+Debug+TiDB+Source+Code+-+Hulua&u=https%3A%2F%2Fyywe.github.io%2Fposts%2Fa-better-way-to-debug-tidb-source-code%2F" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://t.me/share/url?url=https%3A%2F%2Fyywe.github.io%2Fposts%2Fa-better-way-to-debug-tidb-source-code%2F&text=A+Better+Way+to+Debug+TiDB+Source+Code+-+Hulua" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copy link" data-title-succeed="Link copied successfully!"> </i> </span></div></div></div><script> $(function () { /*Get likes count*/ /*Only one element meet the condition thus safe to do so*/ var elemID = null; $(".num_of_likes").map(function () { elemID = $(this).attr("id") }); $.ajax({ url: 'https://my-api-service-344803.uc.r.appspot.com/apis/data/countlikes', type: 'GET', data: { "pids": [elemID] }, traditional: true, success: function (data) { $.each(data, function (key, val) { $('#' + key).text(val) }) }, error: function (xhr, textStatus) { console.log('error in ajax'); console.log(xhr); console.log(textStatus); } }); /*Get page visit count*/ var pageUrl = "/posts/a-better-way-to-debug-tidb-source-code/"; $.ajax({ url: 'https://my-api-service-344803.uc.r.appspot.com/apis/pageviews', type: 'GET', data: { "path": pageUrl}, dataType: "json", success: function (data) { /*Due to history reason, url upper/lower case are different { "/posts/Go-Concurrency-Stop-Signal-And-Timeout/": 12, "/posts/go-concurrency-stop-signal-and-timeout/": 7 }, thus here justify*/ $.each(data, function (key, val) { if (key === pageUrl) { $('#mypv').text(val) } }) }, error: function (xhr, textStatus) { console.log('error in ajax'); console.log(xhr); console.log(textStatus); } }); /*Get IP address*/ var ipAddr = null; $.getJSON('https://api.db-ip.com/v2/free/self', function (data) { /* console.log(JSON.stringify(data, null, 2)); */ ipAddr = data.ipAddress }); /*Bind like button with click event*/ $('#thumbsupbtn').click(function () { if (ipAddr !== null && elemID !== null) { $.ajax({ url: 'https://my-api-service-344803.uc.r.appspot.com/apis/data/likeaction', type: 'POST', dataType: "json", contentType: "application/json; charset=utf-8", data: JSON.stringify({ "pid": elemID, "ip": ipAddr}), traditional: true, success: function (data) { $('#'+elemID).text(data.likenumber) }, error: function (xhr, textStatus) { console.log('error in ajax'); console.log(xhr); console.log(textStatus); } }) } }); }); </script></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted"><div class="access"><div id="access-lastmod" class="post"><div class="panel-heading">Recently Updated</div><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/go-concurrency-write-concurrent-programs/">Go Concurrency - Write Concurrent Programs</a><li><a href="/posts/kubernetes-replicatset-controller/">Kubernetes ReplicaSet Controller Design Principle</a><li><a href="/posts/how-to-traverse-trees-in-rust/">How to Traverse Trees in Rust</a><li><a href="/posts/how-to-persist-your-ssh-session-in-remote-server/">How to Persist Your SSH Session in Remote Server</a><li><a href="/posts/a-better-way-to-debug-tidb-source-code/">A Better Way to Debug TiDB Source Code</a></ul></div><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/concurrency/">concurrency</a> <a class="post-tag" href="/tags/debug/">debug</a> <a class="post-tag" href="/tags/go/">go</a> <a class="post-tag" href="/tags/goroutine/">goroutine</a> <a class="post-tag" href="/tags/kubernetes/">kubernetes</a> <a class="post-tag" href="/tags/source-code/">source code</a> <a class="post-tag" href="/tags/development-environment/">development environment</a> <a class="post-tag" href="/tags/linux/">linux</a> <a class="post-tag" href="/tags/rust/">rust</a> <a class="post-tag" href="/tags/tidb/">TiDB</a></div></div></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="tail-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/how-to-debug-k8s-sourceCode/"><div class="card-body"> <em class="timeago small" data-ts="1648817700" > 2022-04-01 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>How to Debug Kubernetes Source Code?</h3><div class="text-muted small"><p> Reading the source code of kubernetes is a great way to learn the internals of kubernetes. In this post, we will explore how to use debugger (dlv) to track the source code execution flow. Prerequi...</p></div></div></a></div><div class="card"> <a href="/posts/kubernetes-replicatset-controller/"><div class="card-body"> <em class="timeago small" data-ts="1651064100" > 2022-04-27 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Kubernetes ReplicaSet Controller Design Principle</h3><div class="text-muted small"><p> In kubernetes, controllers play a vital role to orchestrate resources. For beginners learning kubernetes, we need to understand what are controllers. In short, controllers manipulate resources. In ...</p></div></div></a></div><div class="card"> <a href="/posts/how-to-persist-your-ssh-session-in-remote-server/"><div class="card-body"> <em class="timeago small" data-ts="1690635300" > 2023-07-29 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>How to Persist Your SSH Session in Remote Server</h3><div class="text-muted small"><p> One of the major advatanage of developing server side applications in your local enviornment is that the terminal session never gets disconnected. The session is always available. 1 2 3 4 5 6 7 8 ...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/how-to-debug-k8s-sourceCode/" class="btn btn-outline-primary" prompt="Older"><p>How to Debug Kubernetes Source Code?</p></a> <a href="/posts/kubernetes-replicatset-controller/" class="btn btn-outline-primary" prompt="Newer"><p>Kubernetes ReplicaSet Controller Design Principle</p></a></div><div id="disqus_thread" class="pt-2 pb-2"><p class="text-center text-muted small"> Comments powered by <a href="https://disqus.com/">Disqus</a>.</p></div><script type="text/javascript"> var disqus_config = function () { this.page.url = 'https://yywe.github.io/posts/a-better-way-to-debug-tidb-source-code/'; this.page.identifier = '/posts/a-better-way-to-debug-tidb-source-code/'; }; /* Lazy loading */ var disqus_observer = new IntersectionObserver(function (entries) { if(entries[0].isIntersecting) { (function () { var d = document, s = d.createElement('script'); s.src = 'https://hulua-tech-blog.disqus.com/embed.js'; s.setAttribute('data-timestamp', +new Date()); (d.head || d.body).appendChild(s); })(); disqus_observer.disconnect(); } }, { threshold: [0] }); disqus_observer.observe(document.querySelector('#disqus_thread')); /* Auto switch theme */ function reloadDisqus() { /* Disqus hasn't been loaded */ if (typeof DISQUS === "undefined") { return; } if (document.readyState == 'complete') { DISQUS.reset({ reload: true, config: disqus_config }); } } const modeToggle = document.querySelector(".mode-toggle"); if (typeof modeToggle !== "undefined") { /* modeToggle.addEventListener('click', reloadDisqus); // not pretty for 'color-scheme' */ window.matchMedia('(prefers-color-scheme: dark)').addEventListener('change', reloadDisqus); } </script></div></div></div><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center text-muted"><div class="footer-left"><p class="mb-0"> <span>Welcome, the site has been visited <em id="my_pv_from_google" class="pageviews"> <i class="fas fa-spinner fa-spin fa-fw"></i> </em> times.</p><p class="mb-0"> © 2023 <a href="https://twitter.com/#">Hulua</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer><script> $(function () { /*Get approximate page visit count using path */ pageUrlroot = "/"; $.ajax({ url: 'https://my-api-service-344803.uc.r.appspot.com/apis/pageviews', type: 'GET', data: { "path": "/"}, dataType: "json", success: function (data) { $.each(data, function (key, val) { if (key === pageUrlroot) { $('#my_pv_from_google').text(val) } }) }, error: function (xhr, textStatus) { console.log('error in ajax'); console.log(xhr); console.log(textStatus); } }); }); </script></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/concurrency/">concurrency</a> <a class="post-tag" href="/tags/debug/">debug</a> <a class="post-tag" href="/tags/go/">go</a> <a class="post-tag" href="/tags/goroutine/">goroutine</a> <a class="post-tag" href="/tags/kubernetes/">kubernetes</a> <a class="post-tag" href="/tags/source-code/">source code</a> <a class="post-tag" href="/tags/development-environment/">development environment</a> <a class="post-tag" href="/tags/linux/">linux</a> <a class="post-tag" href="/tags/rust/">rust</a> <a class="post-tag" href="/tags/tidb/">TiDB</a></div></div></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/lozad/dist/lozad.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/dayjs@1/dayjs.min.js,npm/dayjs@1/locale/en.min.js,npm/dayjs@1/plugin/relativeTime.min.js,npm/dayjs@1/plugin/localizedFormat.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script> <script defer src="/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id=G-SL395S6583"></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', 'G-SL395S6583'); }); </script>
